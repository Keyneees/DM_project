db.status.aggregate({$out: "bad_status"}) + manual remotion of irrelevant status through GUI
db.results.aggregate([{$lookup: {from: "bad_status", foreignField: "statusId", localField: "statusId", as: "status_details"}}, {$lookup: {from: "races", localField:"raceId", foreignField: "raceId", as: "race_details" }},{$project: {_id: 0, resultId: 1, raceId: 1, driverId: 1, constructorId: 1, positionOrder: 1, statusId: 1, "status": "$status_details.status", "race_details.round": 1, "race_details.name": 1, "race_details.year": 1 }}, {$group: {_id: {"year": "$race_details.year", "status": "$status"}, counter: {$sum: 1}}}, {$sort: {"_id.year":1, "counter": -1}}, {$match: {"_id.status": {$ne: []}}}, {$group: {_id: "$_id.year", most_frequent_failure: {$first: "$_id.status"}, count: {$first: "$counter"}}}, {$sort: {"_id":1}}])
db.createView("most_frequent_failure_season", "results", [{$lookup: {from: "bad_status", foreignField: "statusId", localField: "statusId", as: "status_details"}}, {$lookup: {from: "races", localField:"raceId", foreignField: "raceId", as: "race_details" }},{$project: {_id: 0, resultId: 1, raceId: 1, driverId: 1, constructorId: 1, positionOrder: 1, statusId: 1, "status": "$status_details.status", "race_details.round": 1, "race_details.name": 1, "race_details.year": 1 }}, {$group: {_id: {"year": "$race_details.year", "status": "$status"}, counter: {$sum: 1}}}, {$sort: {"_id.year":1, "counter": -1}}, {$match: {"_id.status": {$ne: []}}}, {$group: {_id: "$_id.year", most_frequent_failure: {$first: "$_id.status"}, count: {$first: "$counter"}}}, {$sort: {"_id":1}}])