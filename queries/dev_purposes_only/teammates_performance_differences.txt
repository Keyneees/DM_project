db.createView("season_2018", "races", [{$match: {year:2018}}, {$project: {_id: 0, raceId: 1, round: 1, name: 1}}])
db.createView("Ferrari_standings_2018", "season_2018", [{$lookup: {from: "results", localField: "raceId", foreignField: "raceId", as: "standings"}}, {$unwind: "$standings"}, {$match: {"standings.constructorId": 6}}, {$project: {raceId: 1, round: 1, name: 1, "standings.driverId": 1, "standings.points": 1, "standings.positionOrder": 1}}, {$group: {_id: {raceId: "$raceId", round: "$round"}, standings: {$push: "$standings"}}}])
db.Ferrari_standings_2018.aggregate({$out: "Ferrari_standings_drivers_2018_collection"})
